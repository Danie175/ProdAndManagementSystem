<Page
    x:Class="ProdAndManagementSystem.Views.MaterialInventory"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:ProdAndManagementSystem.Views"
    xmlns:vm="clr-namespace:ProdAndManagementSystem.Views"
    mc:Ignorable="d"
    Title="Materials Management" 
    d:DesignHeight="768" 
    d:DesignWidth="1080">

    <Page.Resources>
        <!-- Windows 11 Inspired Styles -->
        <Style x:Key="Win11Button" TargetType="Button">
            <Setter Property="Background" Value="#f0f0f0"/>
            <Setter Property="Foreground" Value="#202020"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="1" Opacity="0.2" BlurRadius="2"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#e0e0e0"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#d0d0d0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="Win11TabItem" TargetType="TabItem">
            <Setter Property="Foreground" Value="#505050"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Margin" Value="0,0,4,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" 
                                BorderThickness="0,0,0,2" 
                                BorderBrush="Transparent"
                                Background="{TemplateBinding Background}"
                                Margin="{TemplateBinding Margin}" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter ContentSource="Header" 
                                              HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D4"/>
                                <Setter Property="Foreground" Value="#0078D4"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#f5f5f5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="Win11TextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#202020"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#e0e0e0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Margin="0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="Black"/>
                </Trigger>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#0078D4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="Win11ComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#f5f5f5"/>
            <Setter Property="Foreground" Value="#202020"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#e0e0e0"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style x:Key="Win11DatePicker" TargetType="DatePicker">
            <Setter Property="Background" Value="#f5f5f5"/>
            <Setter Property="Foreground" Value="#202020"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#e0e0e0"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style x:Key="Win11DataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#e0e0e0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="RowHeight" Value="38"/>
            <Setter Property="AlternatingRowBackground" Value="#f9f9f9"/>
        </Style>

        <Style x:Key="Win11GroupBox" TargetType="GroupBox">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#e0e0e0"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="0,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#505050"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Grid>

                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Background="White" BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}" 
                                    Grid.RowSpan="2" CornerRadius="6">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="1" BlurRadius="4" Opacity="0.1"/>
                                </Border.Effect>
                            </Border>
                            <Border Grid.Row="0" Background="White" Padding="8,4,0,4">
                                <ContentPresenter ContentSource="Header" RecognizesAccessKey="True" Margin="4,0,0,0"/>
                            </Border>
                            <ContentPresenter Grid.Row="1" Margin="{TemplateBinding Padding}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Page Header -->
            <Border Grid.Row="0" Background="#f8f8f8" Padding="20,15" BorderThickness="0,0,0,1" BorderBrush="#e0e0e0">
                <TextBlock Text="Materials Management" FontSize="24" FontWeight="SemiBold" Foreground="#202020"/>
            </Border>

            <!-- Main Content -->
            <TabControl Grid.Row="1" Margin="20" BorderThickness="0" Background="Transparent">
                <TabItem Header="Material Transactions" Style="{StaticResource Win11TabItem}">
                    <Grid Margin="0,20,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Filters Section -->
                        <GroupBox Grid.Row="0" Header="Filters" Style="{StaticResource Win11GroupBox}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="From Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker x:Name="FromDatePicker" Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding FromDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                    <TextBlock Text="To Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker x:Name="ToDatePicker" Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding ToDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                    <TextBlock Text="Transaction Type" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox x:Name="TransactionTypeFilter" Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding TransactionTypes}" 
                                          SelectedValue="{Binding SelectedTransactionType, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="3" Margin="0,0,10,0">
                                    <TextBlock Text="Material Category" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox x:Name="CategoryFilter" Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Categories}" 
                                          SelectedValue="{Binding SelectedCategory, Mode=TwoWay}"/>
                                </StackPanel>
                                <Button Grid.Column="4" Content="Apply Filters" Style="{StaticResource Win11Button}" 
                                    Command="{Binding ApplyFiltersCommand}" 
                                    Background="#0078D4" Foreground="White" 
                                    VerticalAlignment="Bottom"/>
                            </Grid>
                        </GroupBox>

                        <!-- Material Entry Form -->
                        <GroupBox Grid.Row="1" Header="Material Transaction Entry" Style="{StaticResource Win11GroupBox}" Margin="0,10,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Row 1 -->
                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,10">
                                    <TextBlock Text="Transaction Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding CurrentTransaction.TxDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,10,10">
                                    <TextBlock Text="Transaction Type" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox x:Name="TransactiontypeDropbox" Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding TransactionTypes}" 
                                          SelectedValue="{Binding CurrentTransaction.TransactionType, Mode=TwoWay}" SelectionChanged="TransactiontypeDropbox_SelectionChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,10,10">
                                    <TextBlock Text="Category" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox x:Name="CategoryDropbox"  Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Categories}" 
                                          SelectedValue="{Binding CurrentTransaction.Category, Mode=TwoWay}" IsEditable="True" SelectionChanged="CategoryDropbox_SelectionChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.Column="3" Margin="0,0,0,10">
                                    <TextBlock Text="Material Name" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtMaterialName" Style="{StaticResource Win11TextBox}" 
                                        Text="{Binding CurrentTransaction.DriverName, Mode=TwoWay}" TextChanged="txtMaterialName_TextChanged" Height="31"/>
                                </StackPanel>

                                <!-- Row 2 -->
                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,10">
                                    <TextBlock  Text="Quantity" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtQuantity" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.Quantity, Mode=TwoWay, StringFormat=N2}" TextChanged="txtQuantity_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,10,10">
                                    <TextBlock Text="Rate" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox  x:Name="txtRate" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.Rate, Mode=TwoWay, StringFormat=N2}" TextChanged="txtRate_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,10,10">
                                    <TextBlock  Text="Total Cost" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtTotalCost" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.TotalCost, Mode=TwoWay, StringFormat=N2}"
                                         IsReadOnly="True" TextChanged="txtTotalCost_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.Column="3" Margin="0,0,0,10">
                                    <TextBlock Text="Supplier ID" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox x:Name="SupplierID_Dropbox" Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Suppliers}" 
                                          DisplayMemberPath="Name"
                                          SelectedValuePath="Id"
                                          SelectedValue="{Binding CurrentTransaction.SupplierId, Mode=TwoWay}" SelectionChanged="SupplierID_Dropbox_SelectionChanged"/>
                                </StackPanel>

                                <!-- Row 3 -->
                                <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,10,10">
                                    <TextBlock Text="Invoice Number" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtInvoiceNumber"  Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.InvoiceNumber, Mode=TwoWay}" TextChanged="txtInvoiceNumber_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,0,10,10">
                                    <TextBlock Text="Delivery Chalan No" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtDeliverChalanNo" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.DeliveryChalanNo, Mode=TwoWay}" TextChanged="txtDeliverChalanNo_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="2" Margin="0,0,10,10">
                                    <TextBlock Text="Truck Number" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtTruckNumber" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.TruckNumber, Mode=TwoWay}" TextChanged="txtTruckNumber_TextChanged"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.Column="3" Margin="0,0,0,10">
                                    <TextBlock  Text="Driver Name" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox x:Name="txtDriverName" Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentTransaction.DriverName, Mode=TwoWay}" TextChanged="txtDriverName_TextChanged"/>
                                </StackPanel>

                                <!-- Row 4 -->
                                <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,0,0,10"/>

                                <!-- Action Buttons -->
                                <StackPanel Grid.Row="4" Grid.Column="2" Grid.ColumnSpan="2" 
                                      Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0" Width="326">
                                    <Button x:Name="btnSave" Content="Save" Style="{StaticResource Win11Button}" 
                                        Command="{Binding SaveTransactionCommand}" 
                                        Background="#0078D4" Foreground="White" 
                                        Margin="0,0,10,0" MinWidth="100" Click="btnSave_Click"/>
                                    <Button x:Name="btnClear" Content="Clear" Style="{StaticResource Win11Button}" 
                                        Command="{Binding NewTransactionCommand}" MinWidth="100" Click="btnClear_Click" RenderTransformOrigin="0,0" Margin="-1,0,0,0"/>
                                    <Button x:Name="btnDelete" Content="Delete" Style="{StaticResource Win11Button}" 
                                        Command="{Binding DeleteTransactionCommand}" 
                                        Background="#d83b01" Foreground="White" 
                                        MinWidth="100" Click="btnDelete_Click" Width="102" Margin="10,0,0,0"/>
                                </StackPanel>
                                <TextBox x:Name="txtRemarks" Style="{StaticResource Win11TextBox}" 
                                    Text="{Binding CurrentTransaction.TruckNumber, Mode=TwoWay}" TextChanged="txtRemarks_TextChanged" Margin="-3,9,79,0" Grid.Row="4" Grid.ColumnSpan="2"/>
                                <TextBlock Text="Remarks" FontSize="12" Margin="2,58,8,43" Grid.RowSpan="3" Grid.Row="2"/>
                            </Grid>
                        </GroupBox>

                        <!-- Data Grid -->
                        <GroupBox Grid.Row="2" Header="Material Transactions" Style="{StaticResource Win11GroupBox}">
                            <DataGrid x:Name="TransactionsDataGrid" 
                                  Style="{StaticResource Win11DataGrid}" 
                                  ItemsSource="{Binding MaterialInventories}" 
                                  SelectedItem="{Binding SelectedTransaction}" 
                                  IsReadOnly="True" 
                                  SelectionMode="Single" 
                                  SelectionUnit="FullRow"
                                  HorizontalScrollBarVisibility="Auto" SelectionChanged="TransactionsDataGrid_SelectionChanged">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="Auto"/>
                                    <DataGridTextColumn Header="Date" Binding="{Binding TxDate, StringFormat={}{0:MM/dd/yyyy}}" Width="Auto"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding TransactionType}" Width="Auto"/>
                                    <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="Auto"/>
                                    <DataGridTextColumn Header="Material" Binding="{Binding MaterialName}" Width="Auto"/>
                                    <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity, StringFormat=N2}" Width="Auto"/>
                                    <DataGridTextColumn Header="Rate" Binding="{Binding Rate, StringFormat=N2}" Width="Auto"/>
                                    <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalCost, StringFormat=N2}" Width="Auto"/>
                                    <DataGridTextColumn Header="Supplier" Binding="{Binding Supplier.Name}" Width="Auto"/>
                                    <DataGridTextColumn Header="Invoice " Binding="{Binding InvoiceNumber}" Width="Auto"/>
                                    <DataGridTextColumn Header="Chalan " Binding="{Binding DeliveryChalanNo}" Width="Auto"/>
                                    <DataGridTextColumn Header="Truck " Binding="{Binding TruckNumber}" Width="Auto"/>
                                    <DataGridTextColumn Header="Driver Name" Binding="{Binding DriverName}" Width="Auto"/>
                                    <DataGridTextColumn Header="Remarks" Binding="{Binding Remark}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                    </Grid>
                </TabItem>

                <!-- Inventory Summary Tab -->
                <TabItem Header="Material Summary" Style="{StaticResource Win11TabItem}">
                    <Grid Margin="0,20,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Filters Section -->
                        <GroupBox Grid.Row="0" Header="Filters" Style="{StaticResource Win11GroupBox}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="From Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding SummaryFromDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                    <TextBlock Text="To Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding SummaryToDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <Button Grid.Column="2" Content="Apply Filters" Style="{StaticResource Win11Button}" 
                                    Command="{Binding ApplySummaryFiltersCommand}" 
                                    Background="#0078D4" Foreground="White" 
                                    VerticalAlignment="Bottom"/>
                            </Grid>
                        </GroupBox>

                        <!-- Summary DataGrid -->
                        <GroupBox Grid.Row="1" Header="Material Summary Data" Style="{StaticResource Win11GroupBox}">
                            <ScrollViewer HorizontalScrollBarVisibility="Auto">
                                <DataGrid x:Name="SummaryDataGrid" 
                                      Style="{StaticResource Win11DataGrid}" 
                                      ItemsSource="{Binding MaterialInventoryData}" 
                                      IsReadOnly="True" 
                                      SelectionMode="Single" 
                                      SelectionUnit="FullRow">
                                    <DataGrid.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate>
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding Name}" 
                                                               FontWeight="Bold" 
                                                               FontSize="14" 
                                                               Foreground="#0078D4"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </GroupStyle.HeaderTemplate>
                                        </GroupStyle>
                                    </DataGrid.GroupStyle>

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding TxDate, StringFormat={}{0:MM/dd/yyyy}}" Width="Auto"/>

                                        <!-- Aggregates Category -->
                                        <DataGridTextColumn Header="Agg1 Name" Binding="{Binding Agg1Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg1 Receipt" Binding="{Binding Agg1Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg1 Adjust" Binding="{Binding Agg1Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Agg2 Name" Binding="{Binding Agg2Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg2 Receipt" Binding="{Binding Agg2Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg2 Adjust" Binding="{Binding Agg2Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Agg3 Name" Binding="{Binding Agg3Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg3 Receipt" Binding="{Binding Agg3Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg3 Adjust" Binding="{Binding Agg3Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Agg4 Name" Binding="{Binding Agg4Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg4 Receipt" Binding="{Binding Agg4Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Agg4 Adjust" Binding="{Binding Agg4Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Cement Category -->
                                        <DataGridTextColumn Header="Cement1 Name" Binding="{Binding Cement1Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement1 Receipt" Binding="{Binding Cement1Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement1 Adjust" Binding="{Binding Cement1Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Cement2 Name" Binding="{Binding Cemen2Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement2 Receipt" Binding="{Binding Cemen2Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement2 Adjust" Binding="{Binding Cemen2Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Cement3 Name" Binding="{Binding Cemen3Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement3 Receipt" Binding="{Binding Cemen3Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement3 Adjust" Binding="{Binding Cemen3Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Cement4 Name" Binding="{Binding Cemen4Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement4 Receipt" Binding="{Binding Cemen4Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Cement4 Adjust" Binding="{Binding Cemen4Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Water Category -->
                                        <DataGridTextColumn Header="Water1 Name" Binding="{Binding Water1Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Water1 Receipt" Binding="{Binding Water1Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Water1 Adjust" Binding="{Binding Water1Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Water Category (continued) -->
                                        <DataGridTextColumn Header="Water2 Name" Binding="{Binding Water2Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Water2 Receipt" Binding="{Binding Water2Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Water2 Adjust" Binding="{Binding Water2Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Admixture Category -->
                                        <DataGridTextColumn Header="Admix1 Name" Binding="{Binding Admix1Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix1 Receipt" Binding="{Binding Admix1Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix1 Adjust" Binding="{Binding Admix1Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Admix2 Name" Binding="{Binding Admix2Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix2 Receipt" Binding="{Binding Admix2Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix2 Adjust" Binding="{Binding Admix2Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Admix3 Name" Binding="{Binding Admix3Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix3 Receipt" Binding="{Binding Admix3Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Admix3 Adjust" Binding="{Binding Admix3Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Other Materials Category -->
                                        <DataGridTextColumn Header="Other1 Name" Binding="{Binding Other1Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Other1 Receipt" Binding="{Binding Other1Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Other1 Adjust" Binding="{Binding Other1Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <DataGridTextColumn Header="Other2 Name" Binding="{Binding Other2Name}" Width="Auto"/>
                                        <DataGridTextColumn Header="Other2 Receipt" Binding="{Binding Other2Receipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Other2 Adjust" Binding="{Binding Other2Adjustment, StringFormat=N2}" Width="Auto"/>

                                        <!-- Totals -->
                                        <DataGridTextColumn Header="Total Receipt" Binding="{Binding TotalReceipt, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Total Adjustment" Binding="{Binding TotalAdjustment, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Remarks" Binding="{Binding Remarks}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </ScrollViewer>
                        </GroupBox>
                    </Grid>
                </TabItem>

                <!-- Material Analytics Tab -->
                <TabItem Header="Material Analytics" Style="{StaticResource Win11TabItem}">
                    <Grid Margin="0,20,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Filters and Report Selection -->
                        <GroupBox Grid.Row="0" Header="Analytics Selection" Style="{StaticResource Win11GroupBox}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="From Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding AnalyticsFromDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                    <TextBlock Text="To Date" Margin="0,0,0,4" FontSize="12"/>
                                    <DatePicker Style="{StaticResource Win11DatePicker}" 
                                            SelectedDate="{Binding AnalyticsToDate, Mode=TwoWay}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                    <TextBlock Text="Report Type" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding ReportTypes}" 
                                          SelectedValue="{Binding SelectedReportType, Mode=TwoWay}"/>
                                </StackPanel>
                                <Button Grid.Column="3" Content="Generate Report" Style="{StaticResource Win11Button}" 
                                    Command="{Binding GenerateReportCommand}" 
                                    Background="#0078D4" Foreground="White" 
                                    VerticalAlignment="Bottom"/>
                            </Grid>
                        </GroupBox>

                        <!-- Charts and Analytics -->
                        <TabControl Grid.Row="1" Margin="0,10,0,0" BorderThickness="0" Background="Transparent">
                            <TabItem Header="Usage Trends" Style="{StaticResource Win11TabItem}">
                                <GroupBox Header="Material Usage Over Time" Style="{StaticResource Win11GroupBox}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Chart Controls -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                            <TextBlock Text="Material Category:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <ComboBox Style="{StaticResource Win11ComboBox}" 
                                                  ItemsSource="{Binding Categories}" 
                                                  SelectedValue="{Binding SelectedChartCategory, Mode=TwoWay}"
                                                  Width="150" Margin="0,0,10,0"/>

                                            <TextBlock Text="Chart Type:" VerticalAlignment="Center" Margin="10,0,10,0"/>
                                            <ComboBox Style="{StaticResource Win11ComboBox}" 
                                                  ItemsSource="{Binding ChartTypes}" 
                                                  SelectedValue="{Binding SelectedChartType, Mode=TwoWay}"
                                                  Width="150"/>
                                        </StackPanel>

                                        <!-- Chart Content -->
                                        <Border Grid.Row="1" Background="#fafafa" BorderBrush="#e0e0e0" BorderThickness="1" CornerRadius="4">
                                            <ContentControl Content="{Binding SelectedChartView}"/>
                                        </Border>
                                    </Grid>
                                </GroupBox>
                            </TabItem>

                            <TabItem Header="Cost Analysis" Style="{StaticResource Win11TabItem}">
                                <GroupBox Header="Material Cost Analysis" Style="{StaticResource Win11GroupBox}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Cost Summary -->
                                        <GroupBox Grid.Column="0" Header="Cost Summary" Style="{StaticResource Win11GroupBox}" Margin="0,0,5,0">
                                            <DataGrid Style="{StaticResource Win11DataGrid}" 
                                                  ItemsSource="{Binding CostSummaryData}" 
                                                  IsReadOnly="True" 
                                                  AutoGenerateColumns="False">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="Auto"/>
                                                    <DataGridTextColumn Header="Material" Binding="{Binding MaterialName}" Width="*"/>
                                                    <DataGridTextColumn Header="Total Quantity" Binding="{Binding TotalQuantity, StringFormat=N2}" Width="Auto"/>
                                                    <DataGridTextColumn Header="Avg Rate" Binding="{Binding AverageRate, StringFormat=N2}" Width="Auto"/>
                                                    <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalCost, StringFormat=N2}" Width="Auto"/>
                                                    <DataGridTextColumn Header="% of Total" Binding="{Binding PercentageOfTotal, StringFormat=P2}" Width="Auto"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </GroupBox>

                                        <!-- Cost Distribution Chart -->
                                        <GroupBox Grid.Column="1" Header="Cost Distribution" Style="{StaticResource Win11GroupBox}" Margin="5,0,0,0">
                                            <Border Background="#fafafa" BorderBrush="#e0e0e0" BorderThickness="1" CornerRadius="4">
                                                <ContentControl Content="{Binding CostDistributionChart}"/>
                                            </Border>
                                        </GroupBox>
                                    </Grid>
                                </GroupBox>
                            </TabItem>

                            <TabItem Header="Supplier Analysis" Style="{StaticResource Win11TabItem}">
                                <GroupBox Header="Supplier Performance" Style="{StaticResource Win11GroupBox}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Filter Controls -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                            <TextBlock Text="Material Category:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <ComboBox Style="{StaticResource Win11ComboBox}" 
                                                  ItemsSource="{Binding Categories}" 
                                                  SelectedValue="{Binding SelectedSupplierCategory, Mode=TwoWay}"
                                                  Width="150" Margin="0,0,10,0"/>

                                            <TextBlock Text="Material:" VerticalAlignment="Center" Margin="10,0,10,0"/>
                                            <ComboBox Style="{StaticResource Win11ComboBox}" 
                                                  ItemsSource="{Binding FilteredMaterials}" 
                                                  SelectedValue="{Binding SelectedSupplierMaterial, Mode=TwoWay}"
                                                  Width="150"/>
                                        </StackPanel>

                                        <!-- Supplier Analysis Grid -->
                                        <DataGrid Grid.Row="1" Style="{StaticResource Win11DataGrid}" 
                                              ItemsSource="{Binding SupplierAnalysisData}" 
                                              IsReadOnly="True" 
                                              AutoGenerateColumns="False">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="*"/>
                                                <DataGridTextColumn Header="Total Quantity" Binding="{Binding TotalQuantity, StringFormat=N2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Avg Rate" Binding="{Binding AverageRate, StringFormat=N2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Min Rate" Binding="{Binding MinimumRate, StringFormat=N2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Max Rate" Binding="{Binding MaximumRate, StringFormat=N2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalCost, StringFormat=N2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Last Supply" Binding="{Binding LastSupplyDate, StringFormat={}{0:MM/dd/yyyy}}" Width="Auto"/>
                                                <DataGridTextColumn Header="On-Time Delivery %" Binding="{Binding OnTimeDeliveryPercentage, StringFormat=P2}" Width="Auto"/>
                                                <DataGridTextColumn Header="Quality Rating" Binding="{Binding QualityRating, StringFormat=N1}" Width="Auto"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </GroupBox>
                            </TabItem>

                            <TabItem Header="Inventory Status" Style="{StaticResource Win11TabItem}">
                                <GroupBox Header="Current Inventory Status" Style="{StaticResource Win11GroupBox}">
                                    <DataGrid Style="{StaticResource Win11DataGrid}" 
                                          ItemsSource="{Binding InventoryStatusData}" 
                                          IsReadOnly="True" 
                                          AutoGenerateColumns="False">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="Auto"/>
                                            <DataGridTextColumn Header="Material" Binding="{Binding MaterialName}" Width="*"/>
                                            <DataGridTextColumn Header="Current Stock" Binding="{Binding CurrentStock, StringFormat=N2}" Width="Auto"/>
                                            <DataGridTextColumn Header="Unit" Binding="{Binding Unit}" Width="Auto"/>
                                            <DataGridTextColumn Header="Min Level" Binding="{Binding MinimumLevel, StringFormat=N2}" Width="Auto"/>
                                            <DataGridTextColumn Header="Max Level" Binding="{Binding MaximumLevel, StringFormat=N2}" Width="Auto"/>
                                            <DataGridTextColumn Header="Reorder Level" Binding="{Binding ReorderLevel, StringFormat=N2}" Width="Auto"/>
                                            <DataGridTextColumn Header="Stock Value" Binding="{Binding StockValue, StringFormat=N2}" Width="Auto"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding StockStatus}" Width="Auto"/>
                                            <DataGridTextColumn Header="Last Updated" Binding="{Binding LastUpdated, StringFormat={}{0:MM/dd/yyyy HH:mm}}" Width="Auto"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </GroupBox>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </TabItem>

                <!-- Material Master Tab -->
                <TabItem Header="Material Master" Style="{StaticResource Win11TabItem}">
                    <Grid Margin="0,20,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="350"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Material Master Form -->
                        <GroupBox Grid.Column="0" Header="Material Details" Style="{StaticResource Win11GroupBox}" Margin="0,0,10,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Margin="0,0,0,10">
                                    <TextBlock Text="Material Code" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.Code, Mode=TwoWay}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Margin="0,0,0,10">
                                    <TextBlock Text="Material Name" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.Name, Mode=TwoWay}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="2" Margin="0,0,0,10">
                                    <TextBlock Text="Category" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Categories}" 
                                          SelectedValue="{Binding CurrentMaterial.Category, Mode=TwoWay}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="3" Margin="0,0,0,10">
                                    <TextBlock Text="Unit of Measure" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding UnitOfMeasures}" 
                                          SelectedValue="{Binding CurrentMaterial.UnitOfMeasure, Mode=TwoWay}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="4" Margin="0,0,0,10">
                                    <TextBlock Text="Default Rate" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.DefaultRate, Mode=TwoWay, StringFormat=N2}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="5" Margin="0,0,0,10">
                                    <TextBlock Text="Minimum Stock Level" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.MinimumStock, Mode=TwoWay, StringFormat=N2}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="6" Margin="0,0,0,10">
                                    <TextBlock Text="Maximum Stock Level" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.MaximumStock, Mode=TwoWay, StringFormat=N2}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="7" Margin="0,0,0,10">
                                    <TextBlock Text="Reorder Level" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.ReorderLevel, Mode=TwoWay, StringFormat=N2}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="8" Margin="0,0,0,10">
                                    <TextBlock Text="Default Supplier" Margin="0,0,0,4" FontSize="12"/>
                                    <ComboBox Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Suppliers}" 
                                          DisplayMemberPath="Name"
                                          SelectedValuePath="Id"
                                          SelectedValue="{Binding CurrentMaterial.DefaultSupplierId, Mode=TwoWay}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="9" Margin="0,0,0,10">
                                    <TextBlock Text="Description" Margin="0,0,0,4" FontSize="12"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding CurrentMaterial.Description, Mode=TwoWay}"
                                         TextWrapping="Wrap" AcceptsReturn="True" Height="60"/>
                                </StackPanel>

                                <StackPanel Grid.Row="10" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                                    <Button Content="New" Style="{StaticResource Win11Button}" 
                                        Command="{Binding NewMaterialCommand}" 
                                        Margin="0,0,10,0" MinWidth="80"/>
                                    <Button Content="Save" Style="{StaticResource Win11Button}" 
                                        Command="{Binding SaveMaterialCommand}" 
                                        Background="#0078D4" Foreground="White" 
                                        Margin="0,0,10,0" MinWidth="80"/>
                                    <Button Content="Delete" Style="{StaticResource Win11Button}" 
                                        Command="{Binding DeleteMaterialCommand}" 
                                        Background="#d83b01" Foreground="White" 
                                        MinWidth="80"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <!-- Material Master List -->
                        <GroupBox Grid.Column="1" Header="Material Master List" Style="{StaticResource Win11GroupBox}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Search Box -->
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBox Style="{StaticResource Win11TextBox}" 
                                         Text="{Binding MaterialSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Width="250" Margin="0,0,10,0"/>
                                    <ComboBox Style="{StaticResource Win11ComboBox}" 
                                          ItemsSource="{Binding Categories}" 
                                          SelectedValue="{Binding MaterialFilterCategory, Mode=TwoWay}"
                                          Width="150" Margin="0,0,10,0"/>
                                    <Button Content="Clear Filters" Style="{StaticResource Win11Button}" 
                                        Command="{Binding ClearMaterialFiltersCommand}"/>
                                </StackPanel>

                                <!-- Material Master DataGrid -->
                                <DataGrid Grid.Row="1" Style="{StaticResource Win11DataGrid}" 
                                      ItemsSource="{Binding FilteredMaterials}" 
                                      SelectedItem="{Binding SelectedMaterial, Mode=TwoWay}"
                                      IsReadOnly="True" 
                                      SelectionMode="Single" 
                                      SelectionUnit="FullRow">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Code" Binding="{Binding Code}" Width="Auto"/>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="Auto"/>
                                        <DataGridTextColumn Header="Unit" Binding="{Binding UnitOfMeasure}" Width="Auto"/>
                                        <DataGridTextColumn Header="Default Rate" Binding="{Binding DefaultRate, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Min Stock" Binding="{Binding MinimumStock, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Max Stock" Binding="{Binding MaximumStock, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Reorder Level" Binding="{Binding ReorderLevel, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Current Stock" Binding="{Binding CurrentStock, StringFormat=N2}" Width="Auto"/>
                                        <DataGridTextColumn Header="Default Supplier" Binding="{Binding DefaultSupplier.Name}" Width="Auto"/>
                                    </DataGrid.Columns>
                                </DataGrid>

                            </Grid>
                        </GroupBox>
                    </Grid>
                </TabItem>
            </TabControl>

        </Grid>
    </ScrollViewer>
</Page>